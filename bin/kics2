#!/bin/sh

# Start interactive read-eval-print loop for KiCS2

# Compute the installation directory of the system
PATHNAME=`(cd "\`dirname \"$0\"\`" > /dev/null ; pwd)`
KICS2HOME=`expr "$PATHNAME" : '\(.*\)/bin'`

if [ -x "$KICS2HOME/REPL" ] ; then
  REPL="$KICS2HOME/REPL"
elif [ -x "$KICS2HOME/REPL.state" ] ; then
  REPL="$KICS2HOME/REPL.state"
else
  echo "ERROR: executable for REPL not found!" >&2
  exit 1
fi

# use readline wrapper rlwrap if it is installed and we have tty as stdin:
USERLWRAP=no
if tty -s ; then
  RLWRAP=`which rlwrap`
  if [ -x "$RLWRAP" ] ; then
    USERLWRAP=yes
  fi
fi

if [ "$1" = "--noreadline" ] ; then
  shift
  USERLWRAP=no
fi

if [ $USERLWRAP = yes ] ; then
  exec rlwrap -a -c "$REPL" ${1+"$@"}
else
  exec "$REPL" ${1+"$@"}
fi
