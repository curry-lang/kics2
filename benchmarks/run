#!/bin/bash

# Benchmarks for comparing idcompiler with other systems

TIMEFORMAT="BENCHMARK_USERTIME=%3lU"
PAKCS=/home/pakcs/pakcs/bin/pakcs
SICSTUSBINDIR=/home/sicstus/sicstus4/bin
export PATH=$SICSTUSBINDIR:$PATH
export SWIPL=/home/swiprolog/bin/swipl

echo "BENCHMARK: Reverse / idcompiler"
../compilecurry Reverse
time ./Main
time ./Main
time ./Main
echo "BENCHMARK: Reverse / PAKCS"
$PAKCS -m "print main" -s Reverse
time ./Reverse.state
time ./Reverse.state
time ./Reverse.state
echo "BENCHMARK: Reverse / GHC" 
ghc -O2 --make -fforce-recomp Reverse.hs
time ./Reverse 
time ./Reverse 
time ./Reverse 
rm Reverse
echo "BENCHMARK: Reverse / SICStus-Prolog" 
echo "compile(reverse), save_program('reverse.state',main)." | $SICSTUSBINDIR/sicstus
chmod +x reverse.state
time ./reverse.state 
time ./reverse.state 
time ./reverse.state 
echo "BENCHMARK: Reverse / SWI-Prolog" 
echo "compile(reverse), qsave_program('reverse.state',[toplevel(main)])." | $SWIPL
time ./reverse.state 
time ./reverse.state 
time ./reverse.state 

echo "BENCHMARK: ReversePrimList / PAKCS"
$PAKCS -m "print main" -s ReversePrimList
time ./ReversePrimList.state
time ./ReversePrimList.state
time ./ReversePrimList.state
echo "BENCHMARK: ReversePrimList / GHC" 
ghc -O2 --make -fforce-recomp ReversePrimList.hs
time ./ReversePrimList 
time ./ReversePrimList 
time ./ReversePrimList 
rm ReversePrimList
echo "BENCHMARK: ReversePrimList / SICStus-Prolog" 
echo "compile(reverseprimlist), save_program('reverseprimlist.state',main)." | $SICSTUSBINDIR/sicstus
chmod +x reverseprimlist.state
time ./reverseprimlist.state 
time ./reverseprimlist.state 
time ./reverseprimlist.state 
echo "BENCHMARK: ReversePrimList / SWI-Prolog" 
echo "compile(reverseprimlist), qsave_program('reverseprimlist.state',[toplevel(main)])." | $SWIPL
time ./reverseprimlist.state 
time ./reverseprimlist.state 
time ./reverseprimlist.state 

# clean everything:
rm -f Curry_* Main.* Main *.hi *.o *.state
